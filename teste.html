<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="icon" href="./favicon.ico" type="image/x-icon">
    
    <link rel="stylesheet" href="./css/bootstrap.min.css">
    <link rel="stylesheet" href="./css/style.css">

    <title>Teste Ancoras de Carreira - Robert Half</title>
</head>
<body>
    <div id="main" class="container">
        <h1><span class="badge">TESTE ÂNCORAS DE CARREIRA</span></h1>
        <div id="teste">
            <form id="formPerguntas">
                <label for="inputNome">Nome:</label>
                <input type="text" id="inputNome" name="nome" class="form-control" placeholder="Digite seu nome...">
            </form>
            <button id="btnFormPerguntas" class="btn btn-primary">Enviar</button>
        </div>
        <div id="resultado">
            <div class="row">
                <div class="col-md-6">
                    <h4>Nome: <span id="nome"></span></h4>
                </div>
                <div class="col-md-6">
                    <h4>Emitido as: <span id="data"></span></h4>
                </div>
                <div class="col-6">
                    <div class="card text-center">
                        <div class="card-header">
                            A - Competencia técnica/funcional
                        </div>
                        <div class="card-body">
                            <h5 class="card-title" id="compA">0.00</h5>
                        </div>
                    </div>
                </div>

                <div class="col-6">
                    <div class="card text-center">
                        <div class="card-header">
                            B - Competencia administrativa/geral
                        </div>
                        <div class="card-body">
                            <h5 class="card-title" id="compB">0.00</h5>
                        </div>
                    </div>
                </div>

                <div class="col-6">
                    <div class="card text-center">
                        <div class="card-header">
                            C - Autonomia e independência
                        </div>
                        <div class="card-body">
                            <h5 class="card-title" id="compC">0.00</h5>
                        </div>
                    </div>
                </div>

                <div class="col-6">
                    <div class="card text-center">
                        <div class="card-header">
                            D - Segurança e estabilidade
                        </div>
                        <div class="card-body">
                            <h5 class="card-title" id="compD">0.00</h5>
                        </div>
                    </div>
                </div>

                <div class="col-6">
                    <div class="card text-center">
                        <div class="card-header">
                            E - Criatividade empreendedora
                        </div>
                        <div class="card-body">
                            <h5 class="card-title" id="compE">0.00</h5>
                        </div>
                    </div>
                </div>

                <div class="col-6">
                    <div class="card text-center">
                        <div class="card-header">
                            F - Dedicação a uma causa
                        </div>
                        <div class="card-body">
                            <h5 class="card-title" id="compF">0.00</h5>
                        </div>
                    </div>
                </div>

                <div class="col-6">
                    <div class="card text-center">
                        <div class="card-header">
                            G - Desafio puro
                        </div>
                        <div class="card-body">
                            <h5 class="card-title" id="compG">0.00</h5>
                        </div>
                    </div>
                </div>

                <div class="col-6">
                    <div class="card text-center">
                        <div class="card-header">
                            H - Estilo de vida
                        </div>
                        <div class="card-body">
                            <h5 class="card-title" id="compH">0.00</h5>
                        </div>
                    </div>
                </div>
            </div>
            <button id="btnSalvarResultado" class="btn btn-success">Salvar Resultado</button><button id="btnVoltarPerguntas" class="btn btn-primary">Voltar</button>
        </div><br>
    </div><br><br>

    <script type='text/javascript' src="./js/jquery-3.6.4.min.js"></script>
    <script type='text/javascript' src="./js/bootstrap.bundle.min.js"></script>
    <script type='text/javascript' src="./js/html2canvas.min.js"></script>
    
    <!-- Escrita das perguntas -->
    <script>
        const perguntas = {
            'pergunta1': 'Sonho em ser tão bom no que faço que minha opinião de especialista seja sempre solicitada ',
            'pergunta2': 'Me sinto mais realizado em meu trabalho quando sou capaz de integrar e gerenciar o trabalho dos outros ',
            'pergunta3': 'Sonho em ter uma carreira que me dê a liberdade de fazer o trabalho do meu jeito e no tempo por mim programado ',
            'pergunta4': 'Segurança e estabilidade são mais importantes para mim do que liberdade e autonomia ',
            'pergunta5': 'Estou sempre procurando ideias que me permitam iniciar meu próprio negócio ',
            'pergunta6': 'Sentirei sucesso na minha carreira se sentir que contribuí verdadeiramente para o bem-estar da sociedade ',
            'pergunta7': 'Sonho com uma carreira na qual eu possa solucionar problemas ou vencer em situações extremamente desafiadoras ',
            'pergunta8': 'Prefiro deixar meu emprego a ser colocado em um trabalho que comprometa minha capacidade de satisfazer meus interesses pessoais e familiares ',
            'pergunta9': 'Só me sentirei bem-sucedido em minha carreira se puder desenvolver minhas habilidades técnicas e funcionais até o mais alto nível de competência ',
            'pergunta10': 'Sonho em dirigir uma organização complexa e tomar decisões que afetem muitas pessoas ',
            'pergunta11': 'Me sinto mais realizado em meu trabalho quando tenho total liberdade de definir minhas próprias tarefas, horários e procedimentos ',
            'pergunta12': 'Prefiro manter minha atividade atual a aceitar outra tarefa que possa colocar em risco minha segurança na empresa ',
            'pergunta13': 'Montar meu próprio negócio é mais importante para mim do que atingir uma alta posição gerencial como funcionário ',
            'pergunta14': 'Me sinto mais realizado em minha carreira quando posso utilizar meus talentos a serviço dos outros ',
            'pergunta15': 'Me sinto realizado em minha carreira apenas quando enfrento e supero desafios extremamente difíceis ',
            'pergunta16': 'Sonho com uma carreira que me permita integrar minhas necessidades pessoais, familiares e de trabalho ',
            'pergunta17': 'Me tornar um gerente técnico em minha área de especialização é mais atraente para mim do que me tornar um gerente geral em alguma organização ',
            'pergunta18': 'Me sentirei bem-sucedido em minha carreira apenas quando me tornar um gerente geral em alguma organização ',
            'pergunta19': 'Me sentirei bem-sucedido em minha carreira apenas quando alcançar total autonomia e liberdade ',
            'pergunta20': 'Procuro trabalhos em organizações que me deem senso de segurança e estabilidade  ',
            'pergunta21': 'Me sinto realizado em minha carreira quando sou capaz de construir alguma coisa que seja inteiramente resultado de minhas ideias e esforços ',
            'pergunta22': 'Utilizar minhas habilidades para tornar o mundo um lugar melhor para se viver e trabalhar é mais importante para mim do que alcançar uma posição gerencial de alto nível ',
            'pergunta23': 'Me sinto mais realizado em minha carreira quando soluciono problemas aparentemente insolúveis ou venço o que aparentemente era impossível de ser vencido ',
            'pergunta24': 'Me sinto bem-sucedido na vida apenas quando sou capaz de equilibrar minhas necessidades pessoais, familiares e de carreira ',
            'pergunta25': 'Prefiro sair da empresa onde estou a aceitar uma tarefa em esquema rotativo que me afaste da minha área de experiência ',
            'pergunta26': 'Me tornar um diretor geral é mais atraente para mim do que me tornar um diretor técnico em minha área de especialização ',
            'pergunta27': 'Para mim, poder fazer um trabalho do meu jeito, livre de regras e restrições, é mais importante do que segurança ',
            'pergunta28': 'Me sinto mais realizado em meu trabalho quando percebo que tenho total segurança financeira e estabilidade no trabalho ',
            'pergunta29': 'Me sinto bem-sucedido em meu trabalho apenas quando posso criar ou construir alguma coisa que seja inteiramente de minha autoria ',
            'pergunta30': 'Sonho em ter uma carreira que faça uma real contribuição à humanidade e à sociedade ',
            'pergunta31': 'Procuro oportunidades de trabalho que desafiem fortemente minhas habilidades para solucionar problemas ',
            'pergunta32': 'Equilibrar as exigências da minha vida pessoal e profissional é mais importante do que alcançar alta posição gerencial ',
            'pergunta33': 'Me sinto plenamente realizado em meu trabalho quando sou capaz de empregar minhas habilidades e talentos especiais ',
            'pergunta34': 'Prefiro sair da empresa onde estou a aceitar um cargo que me afaste do caminho da diretoria geral ',
            'pergunta35': 'Prefiro sair da empresa onde estou a aceitar um cargo que reduza minha autonomia e liberdade ',
            'pergunta36': 'Sonho em ter uma carreira que me dê senso de segurança e estabilidade ',
            'pergunta37': 'Sonho em iniciar e montar meu próprio negócio ',
            'pergunta38': 'Prefiro sair da empresa onde estou a aceitar um cargo que prejudique minha capacidade de ser útil aos outros ',
            'pergunta39': 'Trabalhar em problemas praticamente insolúveis para mim é mais importante do que alcançar uma posição gerencial de alto nível ',
            'pergunta40': 'Sempre procurei oportunidades de trabalho que minimizassem interferências com assuntos pessoais e familiares',
        }

        const formPerguntas = document.getElementById('formPerguntas');

        let i = 1;
        for (const pergunta in perguntas) {
            const divPergunta = document.createElement("div");
            divPergunta.id = "pergunta";
            divPergunta.className = "row"
            
            const divLabel = document.createElement("div");
            divLabel.className = "col-md-12"
            divLabel.innerHTML = "<label id='lblPergunta' for='"+pergunta+"'>"+ i + ". " + perguntas[pergunta]+"</label>";

            const divResposta = document.createElement("div");
            divResposta.className = "col-md-8"

            const selectResposta = document.createElement("select");
            selectResposta.id = pergunta;
            selectResposta.name = pergunta;
            selectResposta.className = 'form-select selectResposta';
            selectResposta.required = true;

            const defaultOption = document.createElement("option");
            defaultOption.text = "Selecione uma opção";
            defaultOption.selected = true;
            defaultOption.value = "";
            selectResposta.add(defaultOption);
            
            const options = ["1", "2", "3", "4", "5", "6"];
            options.forEach(optionText => {
                const option = document.createElement("option");
                option.text = optionText;
                selectResposta.add(option);
            });

            const divPontosExtras = document.createElement("div");
            divPontosExtras.className = "col-md-4"

            // const labelPontosExtras = document.createElement("label");
            // labelPontosExtras.for = 'ponto-extra-'+pergunta;
            // labelPontosExtras.innerHTML = "+4 pontos?"
            // divPontosExtras.appendChild(labelPontosExtras);

            const selectPontoExtra = document.createElement("select");
            selectPontoExtra.name = 'ponto-extra-'+pergunta;
            selectPontoExtra.id = 'ponto-extra-'+pergunta;
            selectPontoExtra.className = 'form-select pontoExtra';

            const defaultOptionExtra = document.createElement("option");
            defaultOptionExtra.text = "Adicionar ponto extra?";
            defaultOptionExtra.selected = true;
            defaultOptionExtra.value = "";
            selectPontoExtra.add(defaultOptionExtra);

            const optionsPontoExtra = ["Sim", "Não"];
            optionsPontoExtra.forEach(optionText => {
                const option = document.createElement("option");
                option.text = optionText;

                if(optionText == "Sim"){
                     option.value = 4;
                }else if(option.value == "Não"){
                    option.value = 0;
                }else{
                    option.value = ""
                }
                selectPontoExtra.add(option);
            });

            divPergunta.appendChild(divLabel);
            divResposta.appendChild(selectResposta);
            divPergunta.appendChild(divResposta);
            divPontosExtras.appendChild(selectPontoExtra);
            divPergunta.appendChild(divPontosExtras);
            formPerguntas.appendChild(divPergunta);

            i++;
        }
    </script>

    <!-- Operações -->
    <script>
        function verificaPontoExtra() {
            let pontosExtra = $('.pontoExtra').map((_,el) => el.value).get();

            const count = pontosExtra.filter(arr => {
                if (arr == 4) {
                    return true;
                }
                return false;
            }).length;

            if(count >= 3){
                let selectsPontoExtra = $(".pontoExtra");
                selectsPontoExtra.each(function(){
                    if($(this).val() != 4){
                        $(this).val(0)
                        $(this).attr("disabled", true);
                    }
                })
            }else{
                let selectsPontoExtra = $(".pontoExtra");
                selectsPontoExtra.each(function(){
                    $(this).attr("disabled", false);
                })
            }
        }

        $(".pontoExtra").on("change", function(){
            verificaPontoExtra();
        });
        
        function calculaCompetencia(array, perguntas){
            let calculo = 0;
            for(let i = 0; i < 5; i++){
                let numPergunta = perguntas[i];
                calculo += parseInt(array["pergunta"+numPergunta]);

                if("ponto-extra-pergunta"+numPergunta in array){
                    calculo += parseInt(array["ponto-extra-pergunta"+numPergunta]);
                }                      
            }
            return (calculo/5).toFixed(2);
        }


        $("#btnFormPerguntas").on('click', function(){

            let vazios = false;

            $('select.selectResposta').each(function() {
                if ($(this).val() === "") {
                    vazios = true;
                }
            });

            if($('input#inputNome').val() == ""){
                alert("Preencha o nome");
                return;
            }else if (vazios) {
                alert("Responda todas as perguntas");
                return;
            }

            let data = {};
            let array = $("#formPerguntas").serializeArray();

            array.forEach((item) => {
                console.log(item.name);
                if(item.name == "nome"){
                    data[item.name] = item.value;
                }else if(isNaN(parseInt(item.value))){
                    data[item.name] = 0;
                }else{
                    data[item.name] = parseInt(item.value);
                }
            });

            let competencias = {
                "A": calculaCompetencia(data, [1, 9, 17, 25, 33]),
                "B": calculaCompetencia(data, [2, 10, 18, 26, 34]),
                "C": calculaCompetencia(data, [3, 11, 19, 27, 35]),
                "D": calculaCompetencia(data, [4, 12, 20, 28, 36]),
                "E": calculaCompetencia(data, [5, 13, 21, 29, 37]),
                "F": calculaCompetencia(data, [6, 14, 22, 30, 38]),
                "G": calculaCompetencia(data, [7, 15, 23, 31, 39]),
                "H": calculaCompetencia(data, [8, 16, 24, 32, 40]), 
            }

            $("#compA").html(competencias.A);
            $("#compB").html(competencias.B);
            $("#compC").html(competencias.C);
            $("#compD").html(competencias.D);
            $("#compE").html(competencias.E);
            $("#compF").html(competencias.F);
            $("#compG").html(competencias.G);
            $("#compH").html(competencias.H);
            $("span#nome").html(data['nome'])
            
            let date = new Date();
            let day = date.getDate().toString().padStart(2, '0');
            let month = (date.getMonth() + 1).toString().padStart(2, '0');
            let year = date.getFullYear();
            let hours = date.getHours().toString().padStart(2, '0');
            let minutes = date.getMinutes().toString().padStart(2, '0');
            let seconds = date.getSeconds().toString().padStart(2, '0');

            let formattedDate = `${day}/${month}/${year} ${hours}:${minutes}:${seconds}`;
            console.log(formattedDate);

            $("span#data").html(formattedDate);

            $("#teste").hide();
            $("#resultado").show();
        });

        $("#btnSalvarResultado").on("click", function(){
            html2canvas(document.body).then(function(canvas) {
                let link = document.createElement('a');
                link.href = canvas.toDataURL();
                link.download = 'screenshot.png';
                link.click();
            });
        })

        $("#btnVoltarPerguntas").on("click", function(){
            $("#teste").show();
            $("#resultado").hide();
        });
    </script>
</body>
</html>